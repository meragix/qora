---
title: QoraClientConfig
description: Global configuration for QoraClient. Applied as the baseline for every query. Per-query QoraOptions are merged on top.
---

## Overview

`QoraClientConfig` is passed to the `QoraClient` constructor and sets defaults for every query in the client's lifetime. Individual queries can override any field via `QoraOptions`.

```dart [lib/core/qora.dart]
final client = QoraClient(
  config: QoraClientConfig(
    defaultOptions: QoraOptions(
      staleTime: Duration(minutes: 5),
      cacheTime: Duration(minutes: 10),
      retryCount: 3,
    ),
    debugMode: kDebugMode,
    maxCacheSize: 200,
    refetchOnMount: true,
    errorMapper: (error, stack) => QoraException(
      '$error',
      originalError: error,
      stackTrace: stack,
    ),
  ),
);
```

---

## Constructor

```dart
const QoraClientConfig({
  QoraOptions defaultOptions = const QoraOptions(),
  QoraException Function(Object error, StackTrace? stackTrace)? errorMapper,
  bool debugMode = false,
  int? maxCacheSize,
  void Function(List<dynamic> key)? onCacheEvict,
  bool refetchOnMount = true,
})
```

---

## Fields

### `defaultOptions`

```dart
final QoraOptions defaultOptions
```

**Default:** `QoraOptions()` (all defaults)

The baseline `QoraOptions` applied to every query. Per-query options are merged on top using `QoraOptions.merge()`.

```dart [main.dart]
defaultOptions: QoraOptions(
  staleTime: Duration(minutes: 5),
  cacheTime: Duration(minutes: 10),
  retryCount: 3,
  retryDelay: Duration(seconds: 1),
),
```

→ See [QoraOptions](/api-reference/qora-options) for all available fields.

---

### `errorMapper`

```dart
final QoraException Function(Object error, StackTrace? stackTrace)? errorMapper
```

**Default:** `null` (errors are stored as-is)

Transforms raw errors into `QoraException` before they are stored in `Failure` states. Use this to normalise API-specific error types into a consistent shape across your app:

```dart [main.dart]
errorMapper: (error, stackTrace) {
  if (error is DioException) {
    return QoraException(
      error.message ?? 'Network error',
      originalError: error,
      stackTrace: stackTrace,
    );
  }
  return QoraException('$error', originalError: error, stackTrace: stackTrace);
},
```

When set, all `Failure.error` values will be `QoraException` instances, giving you a single type to check in your error handlers.

---

### `debugMode`

```dart
final bool debugMode
```

**Default:** `false`

Enables verbose `print` logging to the console. Logs:

- Cache hits (fresh and stale)
- Cache misses
- Fetch attempts and retry delays
- Deduplication events
- Lazy eviction and GC removals
- `setQueryData` and `invalidate` calls
- Client disposal

```dart [main.dart]
// Enable only in debug builds
debugMode: kDebugMode,
```

---

### `maxCacheSize`

```dart
final int? maxCacheSize
```

**Default:** `null` (unbounded)

Maximum number of query entries in the cache. When the limit is reached, the **least-recently-used inactive** entry is evicted to make room. Active entries (those with `watchQuery` subscribers) are never forcibly evicted.

```dart [main.dart]
maxCacheSize: 100,  // cap memory usage in list-heavy apps
```

:::tip
A good starting value for most apps is `100–200`. Monitor `client.debugInfo()['total_queries']` to tune this for your usage patterns.
:::

---

### `onCacheEvict`

```dart
final void Function(List<dynamic> key)? onCacheEvict
```

**Default:** `null`

Callback invoked whenever a cache entry is evicted — via LRU pressure, GC timer, `removeQuery`, or `clear`. Receives the normalised key of the evicted entry.

```dart [main.dart]
onCacheEvict: (key) {
  // Log or sync with persistent storage
  print('[Cache] evicted: $key');
  persistentStore.delete(key.toString());
},
```

---

### `refetchOnMount`

```dart
final bool refetchOnMount
```

**Default:** `true`

Global default for whether `watchQuery` should trigger a fetch on the first subscription, even when cached data already exists.

- `true` — always refetch on mount (recommended for most apps)
- `false` — only fetch if no data exists; skip if any cached state is present

Can be overridden per query via `QoraOptions.refetchOnMount`.

```dart [main.dart]
// Global: don't refetch if any data exists
refetchOnMount: false,

// Per-query override: always refetch this specific query
options: QoraOptions(refetchOnMount: true),
```

---

## Recommended Setup

```dart [lib/core/qora.dart]
import 'package:flutter/foundation.dart';
import 'package:qora/qora.dart';

final qoraClient = QoraClient(
  config: const QoraClientConfig(
    defaultOptions: QoraOptions(
      staleTime: Duration(minutes: 5),
      cacheTime: Duration(minutes: 10),
      retryCount: 3,
      retryDelay: Duration(seconds: 1),
    ),
    debugMode: kDebugMode,
    maxCacheSize: 200,
    refetchOnMount: true,
  ),
);
```

For Flutter apps, pass this client to `QoraScope` at the root of your widget tree so all widgets can access it via `context.qora`.
